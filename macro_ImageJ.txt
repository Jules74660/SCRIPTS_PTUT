macro "Segmented Action Tool - Multilines (cm)" {

  // Nombre de points fixe
  N = 16;

  // Crée la table uniquement si la fenêtre Results n'existe pas encore
  if (isOpen("Results") == 0) {
      run("Clear Results"); // créer table vide
  }

  getSelectionCoordinates(xpoints, ypoints);
  getPixelSize(unit, pixelWidth, pixelHeight); 
  // pixelWidth et pixelHeight = taille physique d’un pixel (en cm si échelle définie)

  // Calculer la longueur totale de la ligne en cm
  l = 0;
  for (i = 1; i < xpoints.length; i++) {
     dx = (xpoints[i] - xpoints[i-1]) * pixelWidth;
     dy = (ypoints[i] - ypoints[i-1]) * pixelHeight;
     length = sqrt(dx*dx + dy*dy);  // en cm
     l += length;
  }

  // Intervalle en cm
  ll_cm = l / (N - 1);

  // Conversion en pixels pour Interpolate
  // ⚠ suppose pixels carrés (pixelWidth ≈ pixelHeight)
  ll_px = ll_cm / pixelWidth;

  run("Interpolate", "interval=" + ll_px);
  getSelectionCoordinates(xpoints, ypoints);

  n = nResults; // nombre de lignes déjà présentes dans Results

  for (i = 0; i < xpoints.length; i++) {
      // Conversion des coordonnées pixels → cm
      Xcm = xpoints[i] * pixelWidth;
      Ycm = ypoints[i] * pixelHeight;

      // Ajouter les coordonnées en cm dans Results
      setResult("X (cm)", n + i, Xcm);
      setResult("Y (cm)", n + i, Ycm);
  }
  updateResults();
}
